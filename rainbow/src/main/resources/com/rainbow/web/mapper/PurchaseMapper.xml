<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rainbow.web.mapper.PurchaseMapper"> 
	<insert id="insert" parameterType="com.rainbow.web.purchase.PurchaseDTO"> 
		INSERT INTO RainbowPurchase (member_id, movie_title, screen_number, begin_time, reserve_seat, purchase_price, purchase_time, adult_count, student_count) 
		VALUES (#{memberId}, #{movieTitle}, #{screenNumber}, #{beginTime}, #{reserveSeat}, #{purchasePrice}, NOW(), #{adultCount}, #{studentCount})
	</insert>
	
	<select id="selectList" resultType="com.rainbow.web.purchase.PurchaseDTO">
	    SELECT purchase_seq AS purchaseSeq, member_id AS memberId, movie_title AS movieTitle, screen_number AS screenNumber, begin_time AS beginTime,
	   		reserve_seat AS reserveSeat, purchase_price AS purchasePrice, purchase_time AS purchaseTime, adult_count AS adultCount, student_count AS studentCount
	    FROM RainbowPurchase
	</select>
	
	<select id="selectByMemberId" parameterType="com.rainbow.web.purchase.PurchaseDTO" resultType="com.rainbow.web.purchase.PurchaseDTO">
	    SELECT purchase_seq AS purchaseSeq, member_id AS memberId, movie_title AS movieTitle, screen_number AS screenNumber, begin_time AS beginTime,
	   		reserve_seat AS reserveSeat, purchase_price AS purchasePrice, purchase_time AS purchaseTime, adult_count AS adultCount, student_count AS studentCount
	    FROM RainbowPurchase WHERE member_id = #{memberId}
	</select>
	
	<select id="selectByPurchaseSeq" parameterType="com.rainbow.web.purchase.PurchaseDTO" resultType="com.rainbow.web.purchase.PurchaseDTO">
	    SELECT purchase_seq AS purchaseSeq, member_id AS memberId, movie_title AS movieTitle, screen_number AS screenNumber, begin_time AS beginTime,
	   		reserve_seat AS reserveSeat, purchase_price AS purchasePrice, purchase_time AS purchaseTime, adult_count AS adultCount, student_count AS studentCount
	    FROM RainbowPurchase WHERE purchase_seq = #{purchaseSeq}
	</select>
	
	<select id="count" resultType="int">
	    SELECT count(*) FROM RainbowPurchase
	</select>
	
	<update id="update" parameterType="com.rainbow.web.purchase.PurchaseDTO">
	    UPDATE RainbowPurchase 
	    SET movie_title = #{movieTitle}, screen_number = #{screenNumber}, begin_time = #{beginTime}, reserve_seat = #{reserveSeat}, 
	    	purchase_price = #{purchasePrice}, purchase_time = NOW(), adult_count = #{adultCount}, student_count = #{studentCount}
	    WHERE purchase_seq = #{purchaseSeq}
	</update>
	
	<delete id="delete" parameterType="com.rainbow.web.purchase.PurchaseDTO">
	    DELETE FROM RainbowPurchase WHERE purchase_seq = #{purchaseSeq}
	</delete>
</mapper>